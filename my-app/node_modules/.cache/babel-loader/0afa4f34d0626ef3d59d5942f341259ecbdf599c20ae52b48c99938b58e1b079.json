{"ast":null,"code":"import _objectSpread from\"D:/project/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import{BrowserRouter as Router,Routes,Route,useLocation,Navigate}from'react-router-dom';import axios from'axios';import{toast}from'react-toastify';import'./App.css';// Components\nimport Sidebar from'./components/Sidebar';import BottomNav from'./components/BottomNav';import LandingPage from'./components/LandingPage';import ChatBot from'./components/ChatBot';// Auth Pages\nimport StudentSignIn from'./components/StudentSignIn';import StudentSignUp from'./components/StudentSignUp';import TeacherSignUp from'./components/TeacherSignUp';import TeacherSignIn from'./components/TeacherSignIn';// Student Pages\nimport Dashboard from'./pages/Dashboard';import Events from'./pages/Events';import MyEvents from'./pages/MyEvents';import TicketConfirmation from'./pages/TicketConfirmation';// Teacher Pages\nimport TeacherDashboard from'./pages/TeacherDashboard';import CreateEvent from'./pages/CreateEvent';import EditEvent from'./pages/EditEvent';import TeacherMyEvents from'./pages/TeacherMyEvents';import TeacherEventDetails from'./pages/TeacherEventDetails';import TeacherRegistrations from'./pages/TeacherRegistrations';import EventSpecificRegistrations from'./pages/EventSpecificRegistrations';// Shared Pages\nimport Profile from'./pages/Profile';import EditProfile from'./pages/EditProfile';import ChangePassword from'./pages/ChangePassword';import ThemeSelection from'./pages/ThemeSelection';import EventDetails from'./pages/EventDetails';import Notifications from'./pages/Notifications';import PrivacyPolicy from'./pages/PrivacyPolicy';import HelpCenter from'./pages/HelpCenter';import ForgotPassword from'./pages/ForgotPassword';import ResetPassword from'./pages/ResetPassword';import Settings from'./pages/Settings';import LanguageSelection from'./pages/LanguageSelection';import api,{registrationAPI,eventAPI}from'./api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AppContent=_ref=>{let{isAuthenticated,handleLogin,handleLogout,theme,setTheme,user,setUser,allEvents,handleRegister,handleCancel,searchTerm,setSearchTerm,registeredEvents,filteredEvents,notifications,unreadCount,markNotificationsRead,handleCreateEvent,handleDeleteEvent,handleUpdateEvent,registrations,handleApproveReg,handleRejectReg,handleApproveAll,handleRejectAll}=_ref;const location=useLocation();const isDark=theme==='dark';const[isMobile,setIsMobile]=useState(window.innerWidth<768);const[chatOpen,setChatOpen]=useState(false);useEffect(()=>{const handleResize=()=>setIsMobile(window.innerWidth<768);window.addEventListener('resize',handleResize);return()=>window.removeEventListener('resize',handleResize);},[]);useEffect(()=>{document.body.className=isDark?'dark-mode':'light-mode';document.body.style.backgroundColor=isDark?'#0f172a':'#f8fafc';document.body.style.margin='0';},[isDark]);const isTeacher=(user===null||user===void 0?void 0:user.role)==='teacher';const showNavOn=['/','/events','/my-events','/profile','/dashboard','/teacher-events','/teacher-registrations'];const shouldShowNav=showNavOn.includes(location.pathname)&&isAuthenticated;if(!isAuthenticated){return/*#__PURE__*/_jsx(\"div\",{style:{minHeight:'100vh',backgroundColor:isDark?'#0f172a':'#fff'},children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(LandingPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/signin\",element:/*#__PURE__*/_jsx(StudentSignIn,{onLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/signup\",element:/*#__PURE__*/_jsx(StudentSignUp,{onLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/teacher-signup\",element:/*#__PURE__*/_jsx(TeacherSignUp,{onLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/teacher-signin\",element:/*#__PURE__*/_jsx(TeacherSignIn,{onLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/forgot-password\",element:/*#__PURE__*/_jsx(ForgotPassword,{})}),/*#__PURE__*/_jsx(Route,{path:\"/reset-password/:token\",element:/*#__PURE__*/_jsx(ResetPassword,{})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"app-layout\",style:{display:'flex',minHeight:'100vh',width:'100%'},children:[!isMobile&&/*#__PURE__*/_jsx(Sidebar,{user:user,theme:theme,onLogout:handleLogout},(user===null||user===void 0?void 0:user._id)||(user===null||user===void 0?void 0:user.profileImage)||'sidebar'),/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",style:{flex:1,marginLeft:isMobile?'0px':'60px',width:isMobile?'100%':'calc(100% - 60px)',backgroundColor:isDark?'#0f172a':'#f8fafc',minHeight:'100vh',paddingBottom:'80px',transition:'margin-left 0.3s ease'},children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:isTeacher?/*#__PURE__*/_jsx(TeacherDashboard,{user:user,events:allEvents,theme:theme,toggleTheme:()=>setTheme(theme==='light'?'dark':'light'),onLogout:handleLogout},(user===null||user===void 0?void 0:user._id)||'teacher-dash'):/*#__PURE__*/_jsx(Dashboard,{user:user,events:allEvents,theme:theme,toggleTheme:()=>setTheme(theme==='light'?'dark':'light'),onRegister:handleRegister,unreadCount:unreadCount,onReadNotifications:markNotificationsRead},(user===null||user===void 0?void 0:user._id)||'student-dash')}),isTeacher&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{path:\"/create-event\",element:/*#__PURE__*/_jsx(CreateEvent,{onCreate:handleCreateEvent,theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/edit-event/:id\",element:/*#__PURE__*/_jsx(EditEvent,{events:allEvents,onUpdate:handleUpdateEvent,theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/teacher-events\",element:/*#__PURE__*/_jsx(TeacherMyEvents,{events:allEvents,theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/teacher-event-details/:id\",element:/*#__PURE__*/_jsx(TeacherEventDetails,{events:allEvents,onDelete:handleDeleteEvent,theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/teacher-registrations\",element:/*#__PURE__*/_jsx(TeacherRegistrations,{registrations:registrations,onApprove:handleApproveReg,onReject:handleRejectReg,onApproveAll:handleApproveAll,onRejectAll:handleRejectAll,theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/ticket/:id\",element:/*#__PURE__*/_jsx(TicketConfirmation,{allEvents:allEvents,theme:theme,onCancel:handleCancel})}),/*#__PURE__*/_jsx(Route,{path:\"/ticket-confirmation/:id\",element:/*#__PURE__*/_jsx(TicketConfirmation,{allEvents:allEvents,theme:theme,onCancel:handleCancel})}),/*#__PURE__*/_jsx(Route,{path:\"/event-registrations/:id\",element:/*#__PURE__*/_jsx(EventSpecificRegistrations,{events:allEvents,registrations:registrations,onApprove:handleApproveReg,onReject:handleRejectReg,onApproveAll:handleApproveAll,onRejectAll:handleRejectAll,theme:theme})})]}),!isTeacher&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{path:\"/events\",element:/*#__PURE__*/_jsx(Events,{allEvents:filteredEvents,theme:theme,searchTerm:searchTerm,setSearchTerm:setSearchTerm,onRegister:handleRegister})}),/*#__PURE__*/_jsx(Route,{path:\"/events/:id\",element:/*#__PURE__*/_jsx(EventDetails,{allEvents:allEvents,registrations:registrations,theme:theme,onRegister:handleRegister})}),/*#__PURE__*/_jsx(Route,{path:\"/my-events\",element:/*#__PURE__*/_jsx(MyEvents,{theme:theme,events:registeredEvents,onCancel:handleCancel})}),/*#__PURE__*/_jsx(Route,{path:\"/ticket/:id\",element:/*#__PURE__*/_jsx(TicketConfirmation,{allEvents:allEvents,theme:theme,onCancel:handleCancel})}),/*#__PURE__*/_jsx(Route,{path:\"/ticket-confirmation/:id\",element:/*#__PURE__*/_jsx(TicketConfirmation,{allEvents:allEvents,theme:theme,onCancel:handleCancel})})]}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(Profile,{user:user,theme:theme,onLogout:handleLogout,setUser:setUser})}),/*#__PURE__*/_jsx(Route,{path:\"/edit-profile\",element:/*#__PURE__*/_jsx(EditProfile,{user:user,setUser:setUser,theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/change-password\",element:/*#__PURE__*/_jsx(ChangePassword,{theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/settings/theme\",element:/*#__PURE__*/_jsx(ThemeSelection,{currentTheme:theme,setTheme:setTheme})}),/*#__PURE__*/_jsx(Route,{path:\"/settings/language\",element:/*#__PURE__*/_jsx(LanguageSelection,{currentLanguage:\"English\",setLanguage:()=>{},theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/notifications\",element:/*#__PURE__*/_jsx(Notifications,{theme:theme,user:user,registrations:registrations,notificationsList:notifications})}),/*#__PURE__*/_jsx(Route,{path:\"/privacy\",element:/*#__PURE__*/_jsx(PrivacyPolicy,{theme:theme})}),/*#__PURE__*/_jsx(Route,{path:\"/help\",element:/*#__PURE__*/_jsx(HelpCenter,{theme:theme,openChat:()=>setChatOpen(true)})}),/*#__PURE__*/_jsx(Route,{path:\"/settings\",element:/*#__PURE__*/_jsx(Settings,{theme:theme,user:user})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\"})})]})}),shouldShowNav&&isMobile&&/*#__PURE__*/_jsx(BottomNav,{theme:theme,user:user}),/*#__PURE__*/_jsx(ChatBot,{user:user,isOpen:chatOpen,setIsOpen:setChatOpen})]});};function App(){const[theme,setTheme]=useState(()=>{const saved=localStorage.getItem('theme');return saved||'light';});const[searchTerm,setSearchTerm]=useState(\"\");const[authLoading,setAuthLoading]=useState(true);const[isAuthenticated,setIsAuthenticated]=useState(false);const[user,setUser]=useState(null);// Initialize auth state and fetch user from API on app load\nuseEffect(()=>{const initAuth=async()=>{const token=localStorage.getItem('token');const savedUser=localStorage.getItem('user');if(token){axios.defaults.headers.common[\"Authorization\"]=\"Bearer \".concat(token);// Try to restore user from localStorage first\nif(savedUser){try{const parsedUser=JSON.parse(savedUser);if(parsedUser&&parsedUser.name&&parsedUser.name!=='Guest'){setUser(parsedUser);setIsAuthenticated(true);}}catch(e){console.error('Error parsing saved user:',e);}}// Then fetch fresh user data from API\ntry{const response=await axios.get('http://localhost:5000/api/auth/profile',{headers:{Authorization:\"Bearer \".concat(token)}});const userData=response.data;setUser(_objectSpread(_objectSpread({},userData),{},{token}));setIsAuthenticated(true);localStorage.setItem('user',JSON.stringify(_objectSpread(_objectSpread({},userData),{},{token})));console.log('[App] User fetched from API on init:',userData.name);}catch(error){console.log('[App] Could not fetch user from API:',error.message);// If API fails but we have saved user, keep authenticated\nif(savedUser){setIsAuthenticated(true);}}}setAuthLoading(false);};initAuth();},[]);useEffect(()=>{localStorage.setItem('theme',theme);},[theme]);useEffect(()=>{localStorage.setItem('isAuthenticated',isAuthenticated.toString());},[isAuthenticated]);useEffect(()=>{if(user&&user.name!==\"Guest\"){localStorage.setItem('user',JSON.stringify(user));}},[user]);const toggleTheme=useCallback(()=>{setTheme(prev=>{const newTheme=prev==='light'?'dark':'light';localStorage.setItem('theme',newTheme);return newTheme;});},[]);const handleLogin=useCallback(async userData=>{if(userData){const token=userData.token||'';// Save to localStorage first\nlocalStorage.setItem('user',JSON.stringify(userData));localStorage.setItem('token',token);localStorage.setItem('isAuthenticated','true');// Set axios default header\naxios.defaults.headers.common[\"Authorization\"]=\"Bearer \".concat(token);// Update state\nsetUser(userData);setIsAuthenticated(true);// Fetch fresh user data from API\ntry{const response=await axios.get('http://localhost:5000/api/auth/profile',{headers:{Authorization:\"Bearer \".concat(token)}});const freshUser=response.data;setUser(_objectSpread(_objectSpread({},freshUser),{},{token}));localStorage.setItem('user',JSON.stringify(_objectSpread(_objectSpread({},freshUser),{},{token})));console.log('[App] Fresh user fetched after login:',freshUser.name);}catch(error){console.log('[App] Could not fetch fresh user:',error.message);}}},[]);const handleLogout=useCallback(()=>{setIsAuthenticated(false);setUser(null);localStorage.removeItem('user');localStorage.removeItem('token');localStorage.removeItem('isAuthenticated');// Clear axios default header\ndelete axios.defaults.headers.common[\"Authorization\"];},[]);const[allEvents,setAllEvents]=useState([]);const fetchEvents=useCallback(async()=>{if(!isAuthenticated)return;try{const token=localStorage.getItem('token')||(user===null||user===void 0?void 0:user.token);if(!token){console.log('[App.js] No token found');return;}// Use single endpoint - backend handles role-based filtering\nconst response=await api.get('/events',{headers:{Authorization:\"Bearer \".concat(token)}});console.log(\"Events from API:\",response.data);console.log(\"Upcoming events response:\",response.data);const backendEvents=response.data.map(event=>({id:event._id,_id:event._id,title:event.title,date:new Date(event.date).toISOString().slice(0,16).replace('T',' '),location:event.location,category:'Event',image:event.image||'https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=800&q=80',description:event.description,teacher:event.teacher,status:event.status||'draft'}));setAllEvents(backendEvents);console.log('[App.js] Events fetched successfully:',backendEvents.length);}catch(error){console.log('[App.js] Failed to fetch events, using mock data:',error.message);}},[isAuthenticated,user===null||user===void 0?void 0:user.token]);useEffect(()=>{fetchEvents();},[fetchEvents]);const[registrations,setRegistrations]=useState([]);// Fetch registrations based on role\nconst fetchRegistrations=useCallback(async()=>{if(!isAuthenticated||!(user!==null&&user!==void 0&&user._id))return;try{const token=localStorage.getItem('token')||(user===null||user===void 0?void 0:user.token);if(!token)return;let response;if(user.role==='teacher'){console.log('[App.js] Fetching teacher registrations');response=await registrationAPI.getTeacherRegistrations();}else{console.log('[App.js] Fetching student registrations');response=await registrationAPI.getStudentRegistrations(user._id);}console.log('[App.js] Registrations fetched:',response.data.length);setRegistrations(response.data);}catch(error){console.log('[App.js] Failed to fetch registrations:',error.message);}},[isAuthenticated,user===null||user===void 0?void 0:user.role,user===null||user===void 0?void 0:user._id,user===null||user===void 0?void 0:user.token]);useEffect(()=>{fetchRegistrations();},[fetchRegistrations]);const[notifications,setNotifications]=useState([]);const[unreadCount,setUnreadCount]=useState(0);const fetchNotifications=useCallback(async()=>{if(!isAuthenticated)return;try{const response=await api.get('/notifications');// Backend returns { notifications: [], unreadCount: 0 }\n// We need to extract the array\nconst notifs=response.data.notifications||[];setNotifications(notifs);const unread=response.data.unreadCount!==undefined?response.data.unreadCount:notifs.filter(n=>!n.read).length;setUnreadCount(unread);}catch(error){console.log('[App.js] Failed to fetch notifications:',error);}},[isAuthenticated]);useEffect(()=>{fetchNotifications();// Poll for notifications every 30 seconds\nconst interval=setInterval(fetchNotifications,30000);return()=>clearInterval(interval);},[fetchNotifications]);// handleRegister now accepts an optional callback for navigation\nconst handleRegister=useCallback(async(eventId,onSuccess)=>{// Don't check allEvents - just send to API. Backend validates event exists.\nconsole.log(\"[App.js] Registering for event:\",eventId);try{// Call API to register\nconsole.log(\"[App.js] Sending registration request for eventId:\",eventId);const response=await registrationAPI.register(eventId);console.log(\"[App.js] Registration response status:\",response.status);console.log(\"[App.js] Registration response:\",response.data);if(response.data.registration){console.log(\"[App.js] Registration saved with ID:\",response.data.registration._id);console.log(\"[App.js] Registration status:\",response.data.registration.status);}// Update local state if event exists in allEvents - check both id and _id\nsetAllEvents(prev=>prev.map(ev=>ev.id===eventId||ev._id===eventId?_objectSpread(_objectSpread({},ev),{},{status:'pending'}):ev));// Refresh registrations from database\nawait fetchRegistrations();console.log(\"[App.js] Registration completed successfully!\");toast.success('Registration successful! Waiting for teacher approval.');// Call the success callback if provided\nif(onSuccess){onSuccess();}}catch(error){var _error$response,_error$response2,_error$response3,_error$response3$data;console.log(\"[App.js] Registration FAILED:\");console.log(\"[App.js] Error:\",error.message);console.log(\"[App.js] Error response:\",(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data);console.log(\"[App.js] Error status:\",(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status);const errorMessage=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||error.message||'Registration failed';toast.error('Registration failed: '+errorMessage);}},[allEvents,fetchRegistrations]);// Student cancels their registration\nconst handleCancel=useCallback(async registrationId=>{console.log('[App.js] Cancelling registration:',registrationId);try{const response=await registrationAPI.cancel(registrationId);console.log('[App.js] Cancel response:',response.data);// Remove from local state\nsetRegistrations(prev=>prev.filter(r=>r._id!==registrationId));toast.success('Registration cancelled successfully!');}catch(error){var _error$response4,_error$response5,_error$response5$data;console.log('[App.js] Failed to cancel registration:',((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.data)||error.message);toast.error('Failed to cancel: '+(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.message)||error.message));}},[]);const handleCreateEvent=useCallback(newEvent=>{// The event is already created in the backend by CreateEvent.jsx\n// We just need to update the local state with the returned event data\nsetAllEvents(prev=>[newEvent,...prev]);console.log('[App.js] Event added to state:',newEvent.title);},[]);const handleDeleteEvent=useCallback(async(eventId,navigateCallback)=>{console.log('[App] Deleting event:',eventId);try{const token=localStorage.getItem('token')||(user===null||user===void 0?void 0:user.token);if(!token){console.error('Authentication error. Please login again.');return;}// Use eventAPI to delete\nconst response=await eventAPI.delete(eventId);console.log('[App] Delete response:',response.data);console.log('[App] Event deleted successfully from MongoDB');// Remove from local state after successful delete\nsetAllEvents(prev=>prev.filter(e=>e.id!==eventId&&e._id!==eventId));// Navigate if callback provided\nif(navigateCallback){navigateCallback();}}catch(error){var _error$response6,_error$response7,_error$response7$data;console.error('[App] Error deleting event:',error.message);console.error('[App] Error response:',(_error$response6=error.response)===null||_error$response6===void 0?void 0:_error$response6.data);const errorMsg=((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.message)||error.message||'Failed to delete event';console.error('Error: '+errorMsg);}},[user===null||user===void 0?void 0:user.token]);const handleUpdateEvent=useCallback(async(eventId,updatedData)=>{try{const response=await api.put(\"/events/\".concat(eventId),updatedData);const updatedEvent=response.data;setAllEvents(prev=>prev.map(e=>e.id===eventId||e._id===eventId?updatedEvent:e));return updatedEvent;}catch(error){console.error('Error updating event:',error);// Fallback to local update if API fails\nsetAllEvents(prev=>prev.map(e=>e.id===eventId||e._id===eventId?updatedData:e));throw error;}},[]);const handleApproveReg=useCallback(async regId=>{try{console.log('[App.js] Approving registration:',regId);const response=await registrationAPI.approve(regId);console.log('[App.js] Approve response:',response.data);// Update local registrations state\nsetRegistrations(prev=>prev.map(r=>{var _response$data$ticket;return r._id===regId?_objectSpread(_objectSpread({},r),{},{status:'approved',ticketId:(_response$data$ticket=response.data.ticket)===null||_response$data$ticket===void 0?void 0:_response$data$ticket.ticketCode}):r;}));console.log('[App.js] Registration approved successfully!');toast.success('Registration approved! Ticket generated.');}catch(error){var _error$response8,_error$response9,_error$response9$data;console.log('[App.js] Failed to approve registration:',((_error$response8=error.response)===null||_error$response8===void 0?void 0:_error$response8.data)||error.message);toast.error('Failed to approve: '+(((_error$response9=error.response)===null||_error$response9===void 0?void 0:(_error$response9$data=_error$response9.data)===null||_error$response9$data===void 0?void 0:_error$response9$data.message)||error.message));}},[]);const handleRejectReg=useCallback(async regId=>{try{console.log('[App.js] Rejecting registration:',regId);const response=await registrationAPI.reject(regId);console.log('[App.js] Reject response:',response.data);// Update local registrations state\nsetRegistrations(prev=>prev.map(r=>r._id===regId?_objectSpread(_objectSpread({},r),{},{status:'rejected'}):r));console.log('[App.js] Registration rejected successfully!');toast.success('Registration rejected.');}catch(error){var _error$response0,_error$response1,_error$response1$data;console.log('[App.js] Failed to reject registration:',((_error$response0=error.response)===null||_error$response0===void 0?void 0:_error$response0.data)||error.message);toast.error('Failed to reject: '+(((_error$response1=error.response)===null||_error$response1===void 0?void 0:(_error$response1$data=_error$response1.data)===null||_error$response1$data===void 0?void 0:_error$response1$data.message)||error.message));}},[]);const handleApproveAll=useCallback(async regIds=>{try{console.log('[App.js] Approving ALL registrations:',regIds);const response=await registrationAPI.approveAll(regIds);console.log('[App.js] Approve All response:',response.data);// Update local registrations state\n// The backend returns results which contains updated registration objects with ticketIds\nconst validResults=response.data.results||[];const updatedMap=new Map();validResults.forEach(r=>updatedMap.set(r._id,r));setRegistrations(prev=>prev.map(r=>{if(updatedMap.has(r._id)){// Merge the updated info (status, ticketId)\nconst updated=updatedMap.get(r._id);return _objectSpread(_objectSpread({},r),{},{status:'approved',ticketId:updated.ticketId||updated.ticketCode});}return r;}));// If there were errors, show toast\nif(response.data.errors&&response.data.errors.length>0){toast.warning(\"Approved \".concat(validResults.length,\" registrations. \").concat(response.data.errors.length,\" failed.\"));}else{toast.success(\"Approved \".concat(validResults.length,\" registrations!\"));}}catch(error){var _error$response10,_error$response11,_error$response11$dat;console.log('[App.js] Failed to approve all:',((_error$response10=error.response)===null||_error$response10===void 0?void 0:_error$response10.data)||error.message);toast.error('Failed to approve all: '+(((_error$response11=error.response)===null||_error$response11===void 0?void 0:(_error$response11$dat=_error$response11.data)===null||_error$response11$dat===void 0?void 0:_error$response11$dat.message)||error.message));}},[]);const handleRejectAll=useCallback(async regIds=>{try{console.log('[App.js] Rejecting ALL registrations:',regIds);const response=await registrationAPI.rejectAll(regIds);console.log('[App.js] Reject All response:',response.data);const validResults=response.data.results||[];const updatedIds=new Set(validResults.map(r=>r._id));setRegistrations(prev=>prev.map(r=>updatedIds.has(r._id)?_objectSpread(_objectSpread({},r),{},{status:'rejected'}):r));if(response.data.errors&&response.data.errors.length>0){toast.warning(\"Rejected \".concat(validResults.length,\" registrations. \").concat(response.data.errors.length,\" failed.\"));}else{toast.success(\"Rejected \".concat(validResults.length,\" registrations.\"));}}catch(error){var _error$response12,_error$response13,_error$response13$dat;console.log('[App.js] Failed to reject all:',((_error$response12=error.response)===null||_error$response12===void 0?void 0:_error$response12.data)||error.message);toast.error('Failed to reject all: '+(((_error$response13=error.response)===null||_error$response13===void 0?void 0:(_error$response13$dat=_error$response13.data)===null||_error$response13$dat===void 0?void 0:_error$response13$dat.message)||error.message));}},[]);const markNotificationsRead=useCallback(async()=>{try{await api.put('/notifications/read-all');setUnreadCount(0);setNotifications(prev=>prev.map(n=>_objectSpread(_objectSpread({},n),{},{read:true})));}catch(error){console.error('Failed to mark notifications read:',error);}},[]);const filteredEvents=allEvents.filter(e=>e.title.toLowerCase().includes(searchTerm.toLowerCase()));// MyEvents should use registrations from database\nconst registeredEvents=registrations.map(reg=>{var _reg$event,_reg$event2,_reg$event3,_reg$event4,_reg$event5,_reg$event6;return{_id:((_reg$event=reg.event)===null||_reg$event===void 0?void 0:_reg$event._id)||reg.event,id:((_reg$event2=reg.event)===null||_reg$event2===void 0?void 0:_reg$event2._id)||reg.event,title:((_reg$event3=reg.event)===null||_reg$event3===void 0?void 0:_reg$event3.title)||'Event',date:((_reg$event4=reg.event)===null||_reg$event4===void 0?void 0:_reg$event4.date)||'',location:((_reg$event5=reg.event)===null||_reg$event5===void 0?void 0:_reg$event5.location)||'',image:((_reg$event6=reg.event)===null||_reg$event6===void 0?void 0:_reg$event6.image)||'',status:reg.status,registrationId:reg._id};});// Show loading while restoring auth state\nif(authLoading){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'100vh',backgroundColor:'#f8fafc'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:40,height:40,border:'4px solid #e2e8f0',borderTop:'4px solid #6366f1',borderRadius:'50%',animation:'spin 1s linear infinite'}})});}return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(AppContent,{isAuthenticated:isAuthenticated,handleLogin:handleLogin,handleLogout:handleLogout,theme:theme,setTheme:setTheme,toggleTheme:toggleTheme,user:user,setUser:setUser,allEvents:allEvents,registrations:registrations,registeredEvents:registeredEvents,filteredEvents:filteredEvents,notifications:notifications,unreadCount:unreadCount,searchTerm:searchTerm,setSearchTerm:setSearchTerm,handleRegister:handleRegister,handleCancel:handleCancel,markNotificationsRead:markNotificationsRead,handleCreateEvent:handleCreateEvent,handleDeleteEvent:handleDeleteEvent,handleUpdateEvent:handleUpdateEvent,handleApproveReg:handleApproveReg,handleRejectReg:handleRejectReg,handleApproveAll:handleApproveAll,handleRejectAll:handleRejectAll})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","BrowserRouter","Router","Routes","Route","useLocation","Navigate","axios","toast","Sidebar","BottomNav","LandingPage","ChatBot","StudentSignIn","StudentSignUp","TeacherSignUp","TeacherSignIn","Dashboard","Events","MyEvents","TicketConfirmation","TeacherDashboard","CreateEvent","EditEvent","TeacherMyEvents","TeacherEventDetails","TeacherRegistrations","EventSpecificRegistrations","Profile","EditProfile","ChangePassword","ThemeSelection","EventDetails","Notifications","PrivacyPolicy","HelpCenter","ForgotPassword","ResetPassword","Settings","LanguageSelection","api","registrationAPI","eventAPI","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AppContent","_ref","isAuthenticated","handleLogin","handleLogout","theme","setTheme","user","setUser","allEvents","handleRegister","handleCancel","searchTerm","setSearchTerm","registeredEvents","filteredEvents","notifications","unreadCount","markNotificationsRead","handleCreateEvent","handleDeleteEvent","handleUpdateEvent","registrations","handleApproveReg","handleRejectReg","handleApproveAll","handleRejectAll","location","isDark","isMobile","setIsMobile","window","innerWidth","chatOpen","setChatOpen","handleResize","addEventListener","removeEventListener","document","body","className","style","backgroundColor","margin","isTeacher","role","showNavOn","shouldShowNav","includes","pathname","minHeight","children","path","element","onLogin","to","display","width","onLogout","_id","profileImage","flex","marginLeft","paddingBottom","transition","events","toggleTheme","onRegister","onReadNotifications","onCreate","onUpdate","onDelete","onApprove","onReject","onApproveAll","onRejectAll","onCancel","currentTheme","currentLanguage","setLanguage","notificationsList","openChat","isOpen","setIsOpen","App","saved","localStorage","getItem","authLoading","setAuthLoading","setIsAuthenticated","initAuth","token","savedUser","defaults","headers","common","concat","parsedUser","JSON","parse","name","e","console","error","response","get","Authorization","userData","data","_objectSpread","setItem","stringify","log","message","toString","prev","newTheme","freshUser","removeItem","setAllEvents","fetchEvents","backendEvents","map","event","id","title","date","Date","toISOString","slice","replace","category","image","description","teacher","status","length","setRegistrations","fetchRegistrations","getTeacherRegistrations","getStudentRegistrations","setNotifications","setUnreadCount","fetchNotifications","notifs","unread","undefined","filter","n","read","interval","setInterval","clearInterval","eventId","onSuccess","register","registration","ev","success","_error$response","_error$response2","_error$response3","_error$response3$data","errorMessage","registrationId","cancel","r","_error$response4","_error$response5","_error$response5$data","newEvent","navigateCallback","delete","_error$response6","_error$response7","_error$response7$data","errorMsg","updatedData","put","updatedEvent","regId","approve","_response$data$ticket","ticketId","ticket","ticketCode","_error$response8","_error$response9","_error$response9$data","reject","_error$response0","_error$response1","_error$response1$data","regIds","approveAll","validResults","results","updatedMap","Map","forEach","set","has","updated","errors","warning","_error$response10","_error$response11","_error$response11$dat","rejectAll","updatedIds","Set","_error$response12","_error$response13","_error$response13$dat","toLowerCase","reg","_reg$event","_reg$event2","_reg$event3","_reg$event4","_reg$event5","_reg$event6","justifyContent","alignItems","height","border","borderTop","borderRadius","animation"],"sources":["D:/project/my-app/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { BrowserRouter as Router, Routes, Route, useLocation, Navigate } from 'react-router-dom';\r\n\r\nimport axios from 'axios';\r\nimport { toast } from 'react-toastify';\r\nimport './App.css';\r\n\r\n// Components\r\nimport Sidebar from './components/Sidebar';\r\nimport BottomNav from './components/BottomNav';\r\nimport LandingPage from './components/LandingPage';\r\nimport ChatBot from './components/ChatBot';\r\n\r\n// Auth Pages\r\nimport StudentSignIn from './components/StudentSignIn';\r\nimport StudentSignUp from './components/StudentSignUp';\r\nimport TeacherSignUp from './components/TeacherSignUp';\r\nimport TeacherSignIn from './components/TeacherSignIn';\r\n\r\n// Student Pages\r\nimport Dashboard from './pages/Dashboard';\r\nimport Events from './pages/Events';\r\nimport MyEvents from './pages/MyEvents';\r\nimport TicketConfirmation from './pages/TicketConfirmation';\r\n\r\n// Teacher Pages\r\nimport TeacherDashboard from './pages/TeacherDashboard';\r\nimport CreateEvent from './pages/CreateEvent';\r\nimport EditEvent from './pages/EditEvent';\r\nimport TeacherMyEvents from './pages/TeacherMyEvents';\r\nimport TeacherEventDetails from './pages/TeacherEventDetails';\r\nimport TeacherRegistrations from './pages/TeacherRegistrations';\r\nimport EventSpecificRegistrations from './pages/EventSpecificRegistrations';\r\n\r\n// Shared Pages\r\nimport Profile from './pages/Profile';\r\nimport EditProfile from './pages/EditProfile';\r\nimport ChangePassword from './pages/ChangePassword';\r\nimport ThemeSelection from './pages/ThemeSelection';\r\nimport EventDetails from './pages/EventDetails';\r\nimport Notifications from './pages/Notifications';\r\nimport PrivacyPolicy from './pages/PrivacyPolicy';\r\nimport HelpCenter from './pages/HelpCenter';\r\nimport ForgotPassword from './pages/ForgotPassword';\r\nimport ResetPassword from './pages/ResetPassword';\r\nimport Settings from './pages/Settings';\r\nimport LanguageSelection from './pages/LanguageSelection';\r\n\r\nimport api, { registrationAPI, eventAPI } from './api';\r\n\r\n\r\nconst AppContent = ({\r\n  isAuthenticated, handleLogin, handleLogout,\r\n  theme, setTheme, user, setUser,\r\n  allEvents, handleRegister, handleCancel,\r\n  searchTerm, setSearchTerm, registeredEvents, filteredEvents,\r\n  notifications, unreadCount, markNotificationsRead,\r\n  handleCreateEvent, handleDeleteEvent, handleUpdateEvent,\r\n  registrations, handleApproveReg, handleRejectReg,\r\n  handleApproveAll, handleRejectAll\r\n}) => {\r\n  const location = useLocation();\r\n  const isDark = theme === 'dark';\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\r\n  const [chatOpen, setChatOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => setIsMobile(window.innerWidth < 768);\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    document.body.className = isDark ? 'dark-mode' : 'light-mode';\r\n    document.body.style.backgroundColor = isDark ? '#0f172a' : '#f8fafc';\r\n    document.body.style.margin = '0';\r\n  }, [isDark]);\r\n\r\n  const isTeacher = user?.role === 'teacher';\r\n  const showNavOn = ['/', '/events', '/my-events', '/profile', '/dashboard', '/teacher-events', '/teacher-registrations'];\r\n  const shouldShowNav = showNavOn.includes(location.pathname) && isAuthenticated;\r\n\r\n  if (!isAuthenticated) {\r\n    return (\r\n      <div style={{ minHeight: '100vh', backgroundColor: isDark ? '#0f172a' : '#fff' }}>\r\n        <Routes>\r\n          <Route path=\"/\" element={<LandingPage />} />\r\n          <Route path=\"/signin\" element={<StudentSignIn onLogin={handleLogin} />} />\r\n          <Route path=\"/signup\" element={<StudentSignUp onLogin={handleLogin} />} />\r\n          <Route path=\"/teacher-signup\" element={<TeacherSignUp onLogin={handleLogin} />} />\r\n          <Route path=\"/teacher-signin\" element={<TeacherSignIn onLogin={handleLogin} />} />\r\n          <Route path=\"/forgot-password\" element={<ForgotPassword />} />\r\n          <Route path=\"/reset-password/:token\" element={<ResetPassword />} />\r\n          <Route path=\"*\" element={<Navigate to=\"/\" />} />\r\n        </Routes>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"app-layout\" style={{ display: 'flex', minHeight: '100vh', width: '100%' }}>\r\n      {!isMobile && <Sidebar key={user?._id || user?.profileImage || 'sidebar'} user={user} theme={theme} onLogout={handleLogout} />}\r\n      <div className=\"main-content\" style={{\r\n        flex: 1, marginLeft: isMobile ? '0px' : '60px', width: isMobile ? '100%' : 'calc(100% - 60px)',\r\n        backgroundColor: isDark ? '#0f172a' : '#f8fafc', minHeight: '100vh', paddingBottom: '80px', transition: 'margin-left 0.3s ease'\r\n      }}>\r\n        <Routes>\r\n          <Route path=\"/\" element={\r\n            isTeacher ? (\r\n              <TeacherDashboard key={user?._id || 'teacher-dash'} user={user} events={allEvents} theme={theme} toggleTheme={() => setTheme(theme === 'light' ? 'dark' : 'light')} onLogout={handleLogout} />\r\n            ) : (\r\n              <Dashboard key={user?._id || 'student-dash'} user={user} events={allEvents} theme={theme} toggleTheme={() => setTheme(theme === 'light' ? 'dark' : 'light')} onRegister={handleRegister} unreadCount={unreadCount} onReadNotifications={markNotificationsRead} />\r\n            )\r\n          } />\r\n\r\n          {isTeacher && (\r\n            <>\r\n              <Route path=\"/create-event\" element={<CreateEvent onCreate={handleCreateEvent} theme={theme} />} />\r\n              <Route path=\"/edit-event/:id\" element={<EditEvent events={allEvents} onUpdate={handleUpdateEvent} theme={theme} />} />\r\n              <Route path=\"/teacher-events\" element={<TeacherMyEvents events={allEvents} theme={theme} />} />\r\n              <Route path=\"/teacher-event-details/:id\" element={<TeacherEventDetails events={allEvents} onDelete={handleDeleteEvent} theme={theme} />} />\r\n              <Route path=\"/teacher-registrations\" element={<TeacherRegistrations registrations={registrations} onApprove={handleApproveReg} onReject={handleRejectReg} onApproveAll={handleApproveAll} onRejectAll={handleRejectAll} theme={theme} />} />\r\n              <Route path=\"/ticket/:id\" element={<TicketConfirmation allEvents={allEvents} theme={theme} onCancel={handleCancel} />} />\r\n              <Route path=\"/ticket-confirmation/:id\" element={<TicketConfirmation allEvents={allEvents} theme={theme} onCancel={handleCancel} />} />\r\n              <Route path=\"/event-registrations/:id\" element={<EventSpecificRegistrations events={allEvents} registrations={registrations} onApprove={handleApproveReg} onReject={handleRejectReg} onApproveAll={handleApproveAll} onRejectAll={handleRejectAll} theme={theme} />} />\r\n            </>\r\n          )}\r\n\r\n          {!isTeacher && (\r\n            <>\r\n              <Route path=\"/events\" element={<Events allEvents={filteredEvents} theme={theme} searchTerm={searchTerm} setSearchTerm={setSearchTerm} onRegister={handleRegister} />} />\r\n              <Route path=\"/events/:id\" element={<EventDetails allEvents={allEvents} registrations={registrations} theme={theme} onRegister={handleRegister} />} />\r\n              <Route path=\"/my-events\" element={<MyEvents theme={theme} events={registeredEvents} onCancel={handleCancel} />} />\r\n              <Route path=\"/ticket/:id\" element={<TicketConfirmation allEvents={allEvents} theme={theme} onCancel={handleCancel} />} />\r\n              <Route path=\"/ticket-confirmation/:id\" element={<TicketConfirmation allEvents={allEvents} theme={theme} onCancel={handleCancel} />} />\r\n            </>\r\n          )}\r\n\r\n          <Route path=\"/profile\" element={<Profile user={user} theme={theme} onLogout={handleLogout} setUser={setUser} />} />\r\n          <Route path=\"/edit-profile\" element={<EditProfile user={user} setUser={setUser} theme={theme} />} />\r\n          <Route path=\"/change-password\" element={<ChangePassword theme={theme} />} />\r\n          <Route path=\"/settings/theme\" element={<ThemeSelection currentTheme={theme} setTheme={setTheme} />} />\r\n          <Route path=\"/settings/language\" element={<LanguageSelection currentLanguage=\"English\" setLanguage={() => { }} theme={theme} />} />\r\n          <Route path=\"/notifications\" element={<Notifications theme={theme} user={user} registrations={registrations} notificationsList={notifications} />} />\r\n          <Route path=\"/privacy\" element={<PrivacyPolicy theme={theme} />} />\r\n          <Route path=\"/help\" element={<HelpCenter theme={theme} openChat={() => setChatOpen(true)} />} />\r\n          <Route path=\"/settings\" element={<Settings theme={theme} user={user} />} />\r\n          <Route path=\"*\" element={<Navigate to=\"/\" />} />\r\n        </Routes>\r\n      </div>\r\n      {shouldShowNav && isMobile && <BottomNav theme={theme} user={user} />}\r\n      <ChatBot user={user} isOpen={chatOpen} setIsOpen={setChatOpen} />\r\n    </div>\r\n  );\r\n};\r\n\r\nfunction App() {\r\n  const [theme, setTheme] = useState(() => {\r\n    const saved = localStorage.getItem('theme');\r\n    return saved || 'light';\r\n  });\r\n\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n\r\n  const [authLoading, setAuthLoading] = useState(true);\r\n\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n\r\n  const [user, setUser] = useState(null);\r\n\r\n  // Initialize auth state and fetch user from API on app load\r\n  useEffect(() => {\r\n    const initAuth = async () => {\r\n      const token = localStorage.getItem('token');\r\n      const savedUser = localStorage.getItem('user');\r\n\r\n      if (token) {\r\n        axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\r\n\r\n        // Try to restore user from localStorage first\r\n        if (savedUser) {\r\n          try {\r\n            const parsedUser = JSON.parse(savedUser);\r\n            if (parsedUser && parsedUser.name && parsedUser.name !== 'Guest') {\r\n              setUser(parsedUser);\r\n              setIsAuthenticated(true);\r\n            }\r\n          } catch (e) {\r\n            console.error('Error parsing saved user:', e);\r\n          }\r\n        }\r\n\r\n        // Then fetch fresh user data from API\r\n        try {\r\n          const response = await axios.get('http://localhost:5000/api/auth/profile', {\r\n            headers: { Authorization: `Bearer ${token}` }\r\n          });\r\n\r\n          const userData = response.data;\r\n          setUser({ ...userData, token });\r\n          setIsAuthenticated(true);\r\n          localStorage.setItem('user', JSON.stringify({ ...userData, token }));\r\n          console.log('[App] User fetched from API on init:', userData.name);\r\n        } catch (error) {\r\n          console.log('[App] Could not fetch user from API:', error.message);\r\n          // If API fails but we have saved user, keep authenticated\r\n          if (savedUser) {\r\n            setIsAuthenticated(true);\r\n          }\r\n        }\r\n      }\r\n\r\n      setAuthLoading(false);\r\n    };\r\n\r\n    initAuth();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem('theme', theme);\r\n  }, [theme]);\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem('isAuthenticated', isAuthenticated.toString());\r\n  }, [isAuthenticated]);\r\n\r\n  useEffect(() => {\r\n    if (user && user.name !== \"Guest\") {\r\n      localStorage.setItem('user', JSON.stringify(user));\r\n    }\r\n  }, [user]);\r\n\r\n  const toggleTheme = useCallback(() => {\r\n    setTheme((prev) => {\r\n      const newTheme = prev === 'light' ? 'dark' : 'light';\r\n      localStorage.setItem('theme', newTheme);\r\n      return newTheme;\r\n    });\r\n  }, []);\r\n\r\n  const handleLogin = useCallback(async (userData) => {\r\n    if (userData) {\r\n      const token = userData.token || '';\r\n\r\n      // Save to localStorage first\r\n      localStorage.setItem('user', JSON.stringify(userData));\r\n      localStorage.setItem('token', token);\r\n      localStorage.setItem('isAuthenticated', 'true');\r\n\r\n      // Set axios default header\r\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\r\n\r\n      // Update state\r\n      setUser(userData);\r\n      setIsAuthenticated(true);\r\n\r\n      // Fetch fresh user data from API\r\n      try {\r\n        const response = await axios.get('http://localhost:5000/api/auth/profile', {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n\r\n        const freshUser = response.data;\r\n        setUser({ ...freshUser, token });\r\n        localStorage.setItem('user', JSON.stringify({ ...freshUser, token }));\r\n        console.log('[App] Fresh user fetched after login:', freshUser.name);\r\n      } catch (error) {\r\n        console.log('[App] Could not fetch fresh user:', error.message);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const handleLogout = useCallback(() => {\r\n    setIsAuthenticated(false);\r\n    setUser(null);\r\n    localStorage.removeItem('user');\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('isAuthenticated');\r\n    // Clear axios default header\r\n    delete axios.defaults.headers.common[\"Authorization\"];\r\n  }, []);\r\n\r\n  const [allEvents, setAllEvents] = useState([]);\r\n\r\n  const fetchEvents = useCallback(async () => {\r\n    if (!isAuthenticated) return;\r\n\r\n    try {\r\n      const token = localStorage.getItem('token') || user?.token;\r\n      if (!token) {\r\n        console.log('[App.js] No token found');\r\n        return;\r\n      }\r\n\r\n      // Use single endpoint - backend handles role-based filtering\r\n      const response = await api.get('/events', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n\r\n      console.log(\"Events from API:\", response.data)\r\n      console.log(\"Upcoming events response:\", response.data)\r\n\r\n      const backendEvents = response.data.map(event => ({\r\n        id: event._id,\r\n        _id: event._id,\r\n        title: event.title,\r\n        date: new Date(event.date).toISOString().slice(0, 16).replace('T', ' '),\r\n        location: event.location,\r\n        category: 'Event',\r\n        image: event.image || 'https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=800&q=80',\r\n        description: event.description,\r\n        teacher: event.teacher,\r\n        status: event.status || 'draft'\r\n      }));\r\n\r\n      setAllEvents(backendEvents);\r\n      console.log('[App.js] Events fetched successfully:', backendEvents.length);\r\n    } catch (error) {\r\n      console.log('[App.js] Failed to fetch events, using mock data:', error.message);\r\n    }\r\n  }, [isAuthenticated, user?.token]);\r\n\r\n  useEffect(() => {\r\n    fetchEvents();\r\n  }, [fetchEvents]);\r\n\r\n  const [registrations, setRegistrations] = useState([]);\r\n\r\n  // Fetch registrations based on role\r\n  const fetchRegistrations = useCallback(async () => {\r\n    if (!isAuthenticated || !user?._id) return;\r\n\r\n    try {\r\n      const token = localStorage.getItem('token') || user?.token;\r\n      if (!token) return;\r\n\r\n      let response;\r\n      if (user.role === 'teacher') {\r\n        console.log('[App.js] Fetching teacher registrations');\r\n        response = await registrationAPI.getTeacherRegistrations();\r\n      } else {\r\n        console.log('[App.js] Fetching student registrations');\r\n        response = await registrationAPI.getStudentRegistrations(user._id);\r\n      }\r\n\r\n      console.log('[App.js] Registrations fetched:', response.data.length);\r\n      setRegistrations(response.data);\r\n    } catch (error) {\r\n      console.log('[App.js] Failed to fetch registrations:', error.message);\r\n    }\r\n  }, [isAuthenticated, user?.role, user?._id, user?.token]);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    fetchRegistrations();\r\n  }, [fetchRegistrations]);\r\n\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n\r\n  const fetchNotifications = useCallback(async () => {\r\n    if (!isAuthenticated) return;\r\n    try {\r\n      const response = await api.get('/notifications');\r\n      // Backend returns { notifications: [], unreadCount: 0 }\r\n      // We need to extract the array\r\n      const notifs = response.data.notifications || [];\r\n      setNotifications(notifs);\r\n\r\n      const unread = response.data.unreadCount !== undefined\r\n        ? response.data.unreadCount\r\n        : notifs.filter(n => !n.read).length;\r\n\r\n      setUnreadCount(unread);\r\n    } catch (error) {\r\n      console.log('[App.js] Failed to fetch notifications:', error);\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  useEffect(() => {\r\n    fetchNotifications();\r\n    // Poll for notifications every 30 seconds\r\n    const interval = setInterval(fetchNotifications, 30000);\r\n    return () => clearInterval(interval);\r\n  }, [fetchNotifications]);\r\n\r\n  // handleRegister now accepts an optional callback for navigation\r\n  const handleRegister = useCallback(async (eventId, onSuccess) => {\r\n    // Don't check allEvents - just send to API. Backend validates event exists.\r\n    console.log(\"[App.js] Registering for event:\", eventId);\r\n\r\n    try {\r\n      // Call API to register\r\n      console.log(\"[App.js] Sending registration request for eventId:\", eventId);\r\n      const response = await registrationAPI.register(eventId);\r\n      console.log(\"[App.js] Registration response status:\", response.status);\r\n      console.log(\"[App.js] Registration response:\", response.data);\r\n\r\n      if (response.data.registration) {\r\n        console.log(\"[App.js] Registration saved with ID:\", response.data.registration._id);\r\n        console.log(\"[App.js] Registration status:\", response.data.registration.status);\r\n      }\r\n\r\n      // Update local state if event exists in allEvents - check both id and _id\r\n      setAllEvents(prev => prev.map(ev => (ev.id === eventId || ev._id === eventId) ? { ...ev, status: 'pending' } : ev));\r\n\r\n      // Refresh registrations from database\r\n      await fetchRegistrations();\r\n\r\n      console.log(\"[App.js] Registration completed successfully!\");\r\n      toast.success('Registration successful! Waiting for teacher approval.');\r\n\r\n      // Call the success callback if provided\r\n      if (onSuccess) {\r\n        onSuccess();\r\n      }\r\n    } catch (error) {\r\n      console.log(\"[App.js] Registration FAILED:\");\r\n      console.log(\"[App.js] Error:\", error.message);\r\n      console.log(\"[App.js] Error response:\", error.response?.data);\r\n      console.log(\"[App.js] Error status:\", error.response?.status);\r\n\r\n      const errorMessage = error.response?.data?.message || error.message || 'Registration failed';\r\n      toast.error('Registration failed: ' + errorMessage);\r\n    }\r\n  }, [allEvents, fetchRegistrations]);\r\n\r\n  // Student cancels their registration\r\n  const handleCancel = useCallback(async (registrationId) => {\r\n    console.log('[App.js] Cancelling registration:', registrationId);\r\n    try {\r\n      const response = await registrationAPI.cancel(registrationId);\r\n      console.log('[App.js] Cancel response:', response.data);\r\n\r\n      // Remove from local state\r\n      setRegistrations(prev => prev.filter(r => r._id !== registrationId));\r\n\r\n      toast.success('Registration cancelled successfully!');\r\n    } catch (error) {\r\n      console.log('[App.js] Failed to cancel registration:', error.response?.data || error.message);\r\n      toast.error('Failed to cancel: ' + (error.response?.data?.message || error.message));\r\n    }\r\n  }, []);\r\n\r\n  const handleCreateEvent = useCallback((newEvent) => {\r\n    // The event is already created in the backend by CreateEvent.jsx\r\n    // We just need to update the local state with the returned event data\r\n    setAllEvents(prev => [newEvent, ...prev]);\r\n    console.log('[App.js] Event added to state:', newEvent.title);\r\n  }, []);\r\n\r\n  const handleDeleteEvent = useCallback(async (eventId, navigateCallback) => {\r\n    console.log('[App] Deleting event:', eventId);\r\n    try {\r\n      const token = localStorage.getItem('token') || user?.token;\r\n      if (!token) {\r\n        console.error('Authentication error. Please login again.');\r\n        return;\r\n      }\r\n\r\n      // Use eventAPI to delete\r\n      const response = await eventAPI.delete(eventId);\r\n      console.log('[App] Delete response:', response.data);\r\n      console.log('[App] Event deleted successfully from MongoDB');\r\n\r\n      // Remove from local state after successful delete\r\n      setAllEvents(prev => prev.filter(e => e.id !== eventId && e._id !== eventId));\r\n\r\n      // Navigate if callback provided\r\n      if (navigateCallback) {\r\n        navigateCallback();\r\n      }\r\n    } catch (error) {\r\n      console.error('[App] Error deleting event:', error.message);\r\n      console.error('[App] Error response:', error.response?.data);\r\n\r\n      const errorMsg = error.response?.data?.message || error.message || 'Failed to delete event';\r\n      console.error('Error: ' + errorMsg);\r\n    }\r\n  }, [user?.token]);\r\n\r\n  const handleUpdateEvent = useCallback(async (eventId, updatedData) => {\r\n    try {\r\n      const response = await api.put(`/events/${eventId}`, updatedData);\r\n      const updatedEvent = response.data;\r\n      setAllEvents(prev => prev.map(e => (e.id === eventId || e._id === eventId) ? updatedEvent : e));\r\n      return updatedEvent;\r\n    } catch (error) {\r\n      console.error('Error updating event:', error);\r\n      // Fallback to local update if API fails\r\n      setAllEvents(prev => prev.map(e => (e.id === eventId || e._id === eventId) ? updatedData : e));\r\n      throw error;\r\n    }\r\n  }, []);\r\n\r\n  const handleApproveReg = useCallback(async (regId) => {\r\n    try {\r\n      console.log('[App.js] Approving registration:', regId);\r\n      const response = await registrationAPI.approve(regId);\r\n      console.log('[App.js] Approve response:', response.data);\r\n\r\n      // Update local registrations state\r\n      setRegistrations(prev => prev.map(r =>\r\n        r._id === regId ? { ...r, status: 'approved', ticketId: response.data.ticket?.ticketCode } : r\r\n      ));\r\n\r\n      console.log('[App.js] Registration approved successfully!');\r\n      toast.success('Registration approved! Ticket generated.');\r\n    } catch (error) {\r\n      console.log('[App.js] Failed to approve registration:', error.response?.data || error.message);\r\n      toast.error('Failed to approve: ' + (error.response?.data?.message || error.message));\r\n    }\r\n  }, []);\r\n\r\n  const handleRejectReg = useCallback(async (regId) => {\r\n    try {\r\n      console.log('[App.js] Rejecting registration:', regId);\r\n      const response = await registrationAPI.reject(regId);\r\n      console.log('[App.js] Reject response:', response.data);\r\n\r\n      // Update local registrations state\r\n      setRegistrations(prev => prev.map(r =>\r\n        r._id === regId ? { ...r, status: 'rejected' } : r\r\n      ));\r\n\r\n      console.log('[App.js] Registration rejected successfully!');\r\n      toast.success('Registration rejected.');\r\n    } catch (error) {\r\n      console.log('[App.js] Failed to reject registration:', error.response?.data || error.message);\r\n      toast.error('Failed to reject: ' + (error.response?.data?.message || error.message));\r\n    }\r\n  }, []);\r\n\r\n  const handleApproveAll = useCallback(async (regIds) => {\r\n    try {\r\n      console.log('[App.js] Approving ALL registrations:', regIds);\r\n      const response = await registrationAPI.approveAll(regIds);\r\n      console.log('[App.js] Approve All response:', response.data);\r\n\r\n      // Update local registrations state\r\n      // The backend returns results which contains updated registration objects with ticketIds\r\n      const validResults = response.data.results || [];\r\n      const updatedMap = new Map();\r\n      validResults.forEach(r => updatedMap.set(r._id, r));\r\n\r\n      setRegistrations(prev => prev.map(r => {\r\n        if (updatedMap.has(r._id)) {\r\n          // Merge the updated info (status, ticketId)\r\n          const updated = updatedMap.get(r._id);\r\n          return { ...r, status: 'approved', ticketId: updated.ticketId || updated.ticketCode };\r\n        }\r\n        return r;\r\n      }));\r\n\r\n      // If there were errors, show toast\r\n      if (response.data.errors && response.data.errors.length > 0) {\r\n        toast.warning(`Approved ${validResults.length} registrations. ${response.data.errors.length} failed.`);\r\n      } else {\r\n        toast.success(`Approved ${validResults.length} registrations!`);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.log('[App.js] Failed to approve all:', error.response?.data || error.message);\r\n      toast.error('Failed to approve all: ' + (error.response?.data?.message || error.message));\r\n    }\r\n  }, []);\r\n\r\n  const handleRejectAll = useCallback(async (regIds) => {\r\n    try {\r\n      console.log('[App.js] Rejecting ALL registrations:', regIds);\r\n      const response = await registrationAPI.rejectAll(regIds);\r\n      console.log('[App.js] Reject All response:', response.data);\r\n\r\n      const validResults = response.data.results || [];\r\n      const updatedIds = new Set(validResults.map(r => r._id));\r\n\r\n      setRegistrations(prev => prev.map(r =>\r\n        updatedIds.has(r._id) ? { ...r, status: 'rejected' } : r\r\n      ));\r\n\r\n      if (response.data.errors && response.data.errors.length > 0) {\r\n        toast.warning(`Rejected ${validResults.length} registrations. ${response.data.errors.length} failed.`);\r\n      } else {\r\n        toast.success(`Rejected ${validResults.length} registrations.`);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.log('[App.js] Failed to reject all:', error.response?.data || error.message);\r\n      toast.error('Failed to reject all: ' + (error.response?.data?.message || error.message));\r\n    }\r\n  }, []);\r\n\r\n  const markNotificationsRead = useCallback(async () => {\r\n    try {\r\n      await api.put('/notifications/read-all');\r\n      setUnreadCount(0);\r\n      setNotifications(prev => prev.map(n => ({ ...n, read: true })));\r\n    } catch (error) {\r\n      console.error('Failed to mark notifications read:', error);\r\n    }\r\n  }, []);\r\n  const filteredEvents = allEvents.filter(e => e.title.toLowerCase().includes(searchTerm.toLowerCase()));\r\n\r\n  // MyEvents should use registrations from database\r\n  const registeredEvents = registrations.map(reg => ({\r\n    _id: reg.event?._id || reg.event,\r\n    id: reg.event?._id || reg.event,\r\n    title: reg.event?.title || 'Event',\r\n    date: reg.event?.date || '',\r\n    location: reg.event?.location || '',\r\n    image: reg.event?.image || '',\r\n    status: reg.status,\r\n    registrationId: reg._id\r\n  }));\r\n\r\n  // Show loading while restoring auth state\r\n  if (authLoading) {\r\n    return (\r\n      <div style={{\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        minHeight: '100vh',\r\n        backgroundColor: '#f8fafc'\r\n      }}>\r\n        <div style={{\r\n          width: 40,\r\n          height: 40,\r\n          border: '4px solid #e2e8f0',\r\n          borderTop: '4px solid #6366f1',\r\n          borderRadius: '50%',\r\n          animation: 'spin 1s linear infinite'\r\n        }} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Router>\r\n      <AppContent\r\n        isAuthenticated={isAuthenticated} handleLogin={handleLogin} handleLogout={handleLogout}\r\n        theme={theme} setTheme={setTheme} toggleTheme={toggleTheme} user={user} setUser={setUser}\r\n        allEvents={allEvents} registrations={registrations} registeredEvents={registeredEvents}\r\n        filteredEvents={filteredEvents} notifications={notifications} unreadCount={unreadCount}\r\n        searchTerm={searchTerm} setSearchTerm={setSearchTerm}\r\n        handleRegister={handleRegister} handleCancel={handleCancel} markNotificationsRead={markNotificationsRead}\r\n        handleCreateEvent={handleCreateEvent} handleDeleteEvent={handleDeleteEvent} handleUpdateEvent={handleUpdateEvent}\r\n        handleApproveReg={handleApproveReg} handleRejectReg={handleRejectReg}\r\n        handleApproveAll={handleApproveAll} handleRejectAll={handleRejectAll}\r\n      />\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}